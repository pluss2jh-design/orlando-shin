# 결제 기능 연동 가이드

현재 `orlando-shin` 프로젝트에 기초적인 결제 연동 구조를 추가하였습니다. 실제 결제 서비스를 연동하기 위해 필요한 정보와 절차는 다음과 같습니다.

## 1. 연동 대상 서비스 추천
국내 서비스의 경우 **PortOne (구 아임포트)** 또는 **Toss Payments**를 추천합니다. 
- **PortOne**: 여러 PG사(KG이니시스, 나이스페이 등)를 하나의 API로 통합 관리할 수 있어 확장이 용이합니다.
- **Toss Payments**: 개발자 경험이 우수하며 연동이 매우 빠릅니다.

## 2. 필요한 사용자 정보 (PG 가입용)
결제 연동을 위해 PG사 또는 결제 중개사에 제공해야 할 최소 정보입니다:
- **사업자 등록 정보**: 개인/법인 사업자 번호, 상호명, 대표자명.
- **웹사이트 URL**: 현재 서비스 중인 도메인 (약관 및 하단 푸터 정보 필수).
- **정산 계좌**: 결제 대금이 입금될 은행 계좌 정보.

## 3. 기술적 요구 사항
연동 시 다음 환경 변수를 `.env`에 추가해야 합니다:
- `NEXT_PUBLIC_PORTONE_STORE_ID`: 포트원 상점 아이디
- `PORTONE_API_SECRET`: 포트원 API 시크릿 키 (백엔드 검증용)
- `PAYMENT_CALLBACK_URL`: 결제 완료 후 리다이렉트될 URL

## 4. 연동 프로세스
1. **프론트엔드**: 결제 버튼 클릭 시 결제창 호출 (SDK 이용).
2. **결제 완료**: 사용자가 결제를 마치면 `imp_uid` 또는 `paymentKey`를 수신.
3. **백엔드 검증**: 서버에서 수신한 ID로 실제 결제 여부 및 금액 위변조 확인.
4. **플랜 업데이트**: 검증 성공 시 DB의 `User.plan` 필드를 업데이트하고 세션을 갱신.

## 5. 현재 구현된 부분
- `/api/payment/confirm`: 결제 완료 후 서버에서 검증 및 플랜을 즉시 업데이트하는 엔드포인트 골격.
- `PricingPage`: 플랜 선택 시 결제 프로세스로 진입하는 로직.

*실제 연동을 진행하시려면 PG사 가입 후 부여받은 API Key를 전달해 주시면 즉시 적용해 드리겠습니다.*
